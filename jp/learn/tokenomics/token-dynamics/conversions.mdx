---
title: 変換
description: QuaiとQiトークン間の変換メカニズムの説明。
---

トークン変換は、Quai Networkの最も革新的な機能の一つを表し、数学的に決定されたレートでその二つのネイティブトークン間のシームレスな交換を可能にします。変換システムは、市場メカニズムと安定化ツールの両方として機能し、トークン間の経済的均衡を維持しながら、供給が需要に動的に調整できるようにします。変換メカニズムを理解することは、Quai Networkが自己調整通貨システムを作り出す方法を把握するために不可欠です。

Quai Networkプロトコルは二つのトークンを採用しています：**Quai**、Ethereum Virtual Machine（EVM）互換台帳のネイティブトークン、および**Qi**、固定額面Unspent Transaction Output（UTXO）台帳のネイティブトークン。両方のトークンはマイニング可能で、保有者によってそれらの基本的な経済関係を反映するプロトコル定義の交換レートで相互変換可能です。洗練されたコントローラーメカニズムが、QuaiとQiの間の中立性を保証し、いずれかのトークンに対する固有のバイアスを防ぎ、公正な変換レートを維持します。

このセクションでは、プロトコル内のマイナー難易度、変換フロー、交換レート、取引調整を統括する数学的定式化を詳述します。変換システムは、二重トークン経済において安定性と応答性を生み出すために連携して動作する複数の相互接続されたメカニズムを通じて運営されます。

> **注**  
> すべての変換取引は2週間ロックアップされます

---

## コア構成要素

### マイナー難易度

ブロック`i`でのマイナー難易度、`minerDifficulty_i`と表記される、は4000ブロックウィンドウにわたるプライムブロック難易度の指数移動平均（EMA）として計算されます。これは、ネットワーク変化への応答性と長期的安定性のバランスを取ります：

<Frame>
<img src='/images/minerDifficulty.png' />
</Frame>

- `minerDifficulty_{i-1}`：前のブロックでの難易度。  
- `blockDifficulty_i`：現在のプライムブロックの難易度。  

この平均化により、進化するネットワーク状況に適応しながら短期的な変動が平滑化されます。

---

### ブロック報酬と`k_Qi`

ブロック報酬は、係数`k_Quai`と`k_Qi`によってそれぞれスケールされ、QuaiまたはQiで配布されます：

- **Quaiブロック報酬**：  
  `reward_Quai = k_Quai × log2(blockDifficulty_i)`

- **Qiブロック報酬**：  
  `reward_Qi = k_Qi × blockDifficulty_i`

プロトコルは`k_Qi`をハッシュレート効率に結び付けられた動的パラメーターとして扱い、これはGPUパフォーマンス改善とともに進化します。[Epoch AI](https://epoch.ai/blog/predicting-gpu-performance)の研究に基づいて、GPU効率（フロップスで測定）は、より小さなトランジスタとコア数の増加により2.69年ごとに倍増し、2030年以降にプラトーに達します。二回の倍増後の飽和を仮定して、`k_Qi`はブロック高（`number`）で調整されます：

<Frame>
<img src='/images/kQi.png' />
</Frame>

ここで：  
- `baseKqi = 1 / (8 × 10^9)`  
- `doublingPeriodInBlocks = (365 × BlocksPerDay × 2.69)`  
- `doublingCount = floor(number / doublingPeriodInBlocks)`  
- `remainingBlocks = number - doublingCount × doublingPeriodInBlocks`  
- `BlocksPerDay`：1日にマイニングされるブロックの定数。  

技術的傾向に調整される`k_Qi`とは異なり、`k_Quai`はトークン中立性を維持するためにプロトコルによって積極的に制御されます。以下のすべての交換レート参照は`k_Quai`に関連します。

---

### 変換フロー量と割引

ブロック`i`での変換フロー量、`conversionFlowAmount_i`は、**立方変換フロー割引**と**K-Quai割引**の二つの割引によって調整されたQuai変換量のEMAです。最小閾値を含みます：

<Frame>
<img src='/images/conversionFlowAmount.png' />
</Frame>

- `conversionFlowAmount_{i-1}`：前のブロックの変換フロー量。  
- `currentFlowAmount_i`：割引前の現在のブロックの変換量。  

ベースラインフローを保つために100 Quaiの最小変換フロー量が維持されます。調整された変換フローは、前の量の2倍でも制限されます。

#### 立方変換フロー割引

各変換取引は立方割引を受けます：

<Frame>
<img src='/images/flowDiscount.png' />
</Frame>

#### K-Quai割引

K-Quai割引は、4000ブロックウィンドウにわたるコントローラー調整方向に応じて、任意の時点で一種類の変換のみに適用されます。
交換レートが上昇している場合、割引はQuaiからQiへの変換に適用され、交換レートが下降している場合、割引は
QiからQuaiへの変換のみに適用されます。

<Frame>
<img src='/images/kQuaiDiscount.png' />
</Frame>

#### 割引上限

`finalValue ≥ 0.1 × originalValue`

#### 最大スリップ仕様

- **Quai-to-Qi**：  
  - 最大スリップデフォルト：90%（9000ベーシスポイント）  
  - データフィールドの最初の2バイトで指定  
  - 払い戻しは次のゾーンブロックで`etx`を通じて実行  

- **Qi-to-Quai**：  
  - データフィールドは22バイトである必要：バイト0–1はスリップ用、2–21は払い戻しアドレス用  
  - 払い戻しは2週間ロック、1 Qi精度  

---

### 交換レート計算

<Frame>
<img src='/images/exchangeRate.png' />
</Frame>

ここで：  
- `kQuai_{i-1}`：前のレート  
- `α = 0.001`  
- `d`：正規化難易度  
- `d*`：ターゲット難易度  

#### 正規化難易度

<Frame>
<img src='/images/normalizedDifficulty.png' />
</Frame>

#### ターゲット難易度

過去4000ブロックの調整難易度の単純平均。

---

### 取引処理と調整難易度

1. **コインベース取引**：QuaiまたはQiへの選択を追加  
2. **変換取引**：宛先ブロック報酬によって正規化  

<Frame>
<img src='/images/adjDifficulty.png' />
</Frame>

符号はトークン選択の多数派に依存します。

---

## まとめ

Quai/Qiコントローラーは、相互接続されたメカニズムを通じて均衡を維持します：マイナー難易度はネットワーク努力に調整し、変換フローは安定化割引を適用し、交換レートは正規化およびターゲット難易度とともに進化します。取引ベースの調整がシステムをさらに精緻化し、二重トークンフレームワークでの公正性と安定性を保証します。これらのダイナミクスは、マイナーの行動、変換傾向、ネットワーク活動に適応し、プロトコルの中立設計を維持します。

Qiの排出が技術的傾向に調整され、他のすべてのメカニズムがQiとQuaiの間のトークン中立性を求める中で、Qiは時間の経過とともに安定した価値を持つエネルギー（消費されたハッシュ）のトークン化表現となり、価値保存手段となるQuaiと比較されます。