---
title: 瞬間的フォーク解決
description: PoEMコンセンサスメカニズムがいかにコンセンサスベースのフォークを排除したか
---

## フォーク解決が重要な理由

2人のマイナーが同時に有効なブロックを見つけると、従来のブロックチェーンはジレンマに直面します：ネットワークはどのブロックを受け入れるべきか？これにより、ネットワークが競合チェーンに分裂する一時的な「フォーク」が生じます。

**ユーザーへの影響：**
- **トランザクション不確実性**：負けフォークにある場合、トランザクションが逆転される可能性
- **確認遅延**：最終性を保証するために追加ブロックを待つ必要
- **高手数料**：限られたブロックスペースを競合することによるネットワーク渋滞

**マイナーへの影響：**
- **エネルギーの無駄**：マイニングパワーが競合チェーン間で分割
- **報酬減少**：勝利フォークのマイナーのみが支払いを受ける
- **戦略的不確実性**：どのチェーンでマイニングするか不明確

## 従来のアプローチ：待機して見る

Bitcoinのようなプルーフ・オブ・ワークシステムでは、2つの有効なブロックが同時に現れると、それらの間を即座に選択する方法がありません。両方のブロックが困難度要件を満たすため、ネットワークは待つ必要があります：

1. **分裂発生**：マイナーがどちらのブロックを基盤にするかをランダムに選択
2. **ネットワーク分割**：マイニングパワーが競合チェーン間で分割
3. **解決待機**：誰かが次のブロックを見つけるまで、ネットワークはどのチェーンをフォローするかわからない
4. **時間コスト**：Bitcoinではこれが10分以上かかる可能性

## PoEMのソリューション：真の作業を測定

ここに重要な洞察があります：**すべての有効なブロックが実際に等しいわけではない**。2つのブロックが両方とも困難度要件を満たしていても、1つは常に他よりわずかに多くの作業を作成するために必要でした。

従来のプルーフ・オブ・ワークはこの違いを無視し、「十分に良い」ブロックを同一として扱います。PoEMは各ブロックの正確な作業量（除去されたエントロピー）を測定し、即座で客観的な決定を可能にします。

**PoEMがフォークを即座に解決する方法：**
1. **2つのブロックが現れる**：両方とも最小困難度要件を満たす
2. **正確な作業を測定**：PoEMが各ブロックによって除去された正確なエントロピーを計算
3. **明確な勝者**：より多くのエントロピーを除去したブロックが客観的により良い
4. **即座のコンセンサス**：すべてのノードが即座にどのブロックをフォローするかを知る

## 技術的実装

PoEMは[内在ブロック重み](/jp/learn/advanced-introduction/poem/fork-choice/intrinsic-block-weight)を使用して各ブロックで行われた正確な作業を測定します。単に「このブロックは最小要件を満たしたか？」をチェックする代わりに、PoEMは「このブロックに正確にどのくらいの作業が投入されたか？」を問います。

この精度により、いくつかの重要な利点が可能になります：

**ネットワーク効率：**
- **単一証明伝播**：コンセンサスを達成するために1つのブロックのみを共有する必要
- **無駄なマイニングなし**：すべての計算作業がネットワークセキュリティに貢献
- **永続的コンセンサス**：ノードが常に現在のチェーン先端に合意

**スケーラビリティメリット：**
- **即座の協調**：無制限の並列チェーンを管理可能
- **レイテンシ影響なし**：ネットワーク遅延がコンセンサス決定に影響しない
- **決定論的結果**：同じ情報が与えられると、すべてのノードが同一選択をする

<Frame>
	<img src='/images/PoWvsPoEMForkResolution.jpg' />
</Frame>

## 永続的コンセンサス

「十分に良い」閾値ではなく正確な作業を測定することで、PoEMはコンセンサスの動作方法を根本的に変えます。合意に達する定期的な試行の代わりに、PoEMは**永続的コンセンサス**を達成します - すべてのノードが常に現在の状態に合意します。

これにより前例のない能力が可能になります：
- **フォーク不確実性なし**：ユーザーはトランザクションが即座に最終であることを知る
- **無限のスケーラビリティ**：無制限の並列チェーンを協調可能
- **最大効率**：すべてのマイニングパワーがネットワーク全体を保護
- **レイテンシ耐性**：ネットワーク遅延がコンセンサス紛争を作らない

## 実世界の例

<Frame>
	<img src='/images/ForkResolutionDiagram.jpg' />
</Frame>

2人のマイナーが同時に競合ブロックを見つけることを想像してください：

**設定：**
- 両ブロックが最小困難度要件（16個の先頭ゼロ）を満たす
- ブロックAハッシュ：`0x0000b9c86d37...`
- ブロックBハッシュ：`0x0000b9c86d30...`

### 従来のPoWの処理方法：

1. **両ブロックが有効** - 各々が16個の先頭ゼロを持ち、要件を満たす
2. **ネットワーク分裂** - マイナーの半分がブロックAで作業、半分がブロックBで作業
3. **解決を待つ** - 誰かがブロック3を見つけるまで10分以上待つ必要
4. **勝者決定** - どちらのチェーンが最初にブロック3を取得したかが正規となる
5. **作業無駄** - 負けチェーンでのすべてのマイニングが破棄

**結果**：不確実性、エネルギーの無駄、最終性の遅延

### PoEMの処理方法：

1. **正確な作業を測定** - ブロックAが16.462525964ビットのエントロピーを除去
2. **ブロックBがより多く除去** - ブロックBが16.462525967ビットのエントロピーを除去
3. **即座の決定** - すべてのノードが即座にブロックBがより良いと認識
4. **統一マイニング** - すべてのマイナーがブロックBを基盤に構築することに切り替え
5. **無駄なし** - すべての計算作業がネットワークセキュリティに貢献

**結果**：即座のコンセンサス、最大効率、即座の最終性

<Note>
エントロピーの差は微小（0.000000003ビット）ですが、数学的に決定的です。この精度により、あらゆる曖昧さなしにすべてのノードが同じ選択をすることが保証されます。
</Note>