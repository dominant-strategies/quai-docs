---
title: マルチスレッド実行
description: Quai Networkがいかに並列でトランザクションを処理するか
---

## シングルコアからマルチコアブロックチェーンへ

コンピューティングの初期時代では、プロセッサは一度に一つのタスクしか処理できませんでした。すべてが順番を待つ必要があり、パフォーマンスを制限するボトルネックが生じていました。マルチコアCPUの発明がすべてを変えました。突然、コンピュータは複数のタスクを同時に処理できるようになり、大幅なパフォーマンス向上を実現しました。Quaiは同じ革命をブロックチェーン技術にもたらします。

従来のブロックチェーンはシングルコアプロセッサのように動作します。すべてのトランザクションは列に並んで、一つの処理チャネルを通して順番を待つ必要があります。混雑時には、これは大規模な渋滞を引き起こします。まるで都市全体の交通を単一の車線に流し込もうとするようなものです。ユーザーは高い手数料、長い待ち時間、失敗したトランザクションを経験します。

**マルチコアソリューション：**
Quaiのマルチスレッド実行により、複数のブロックチェーンスレッドがトランザクションを並列処理できます。これは、現代のCPUが複数のタスクを同時に処理するのと同様です。各ゾーンチェーンは独立した実行スレッドとして動作し、より広いネットワークと同期を保ちながら独自のトランザクションを処理します。

**Quaiがこれを実現する方法：**
ブレークスルーは、従来のブロックチェーンが密結合していた2つの概念を分離することから生まれます：ローカル一貫性（ゾーン内の全員が合意する）とグローバルコンセンサス（ネットワーク全体が合意する）。Quaiでは：
- ゾーンが自分のトランザクションに対して即座にローカルコンセンサスを達成
- グローバルコンセンサスはブロックが階層に織り込まれる過程で段階的に実現
- ユーザーはネットワーク全体のセキュリティを維持しながら高速確認を取得

このアーキテクチャは真の並列処理を可能にし、複数のゾーンが互いを待つことなく同時にブロックを生成でき、全体のスループットを劇的に向上させます。

<Frame>
	<img src='/images/BlockchainVisualization.webp' />
</Frame>

## 一貫性とグローバルコンセンサスの分離

Quaiのブレークスルーを理解するには、従来のブロックチェーンが混同している2つの概念を区別する必要があります。一貫性とは、すべてのノードが同じデータを持っていることを意味します。これは、皆が共有ドキュメントの同じバージョンを持っているようなものです。コンセンサスとは、そのバージョンが正しいことに全員が合意することを意味します。これは、そのドキュメントに皆がサインオフするようなものです。

従来のブロックチェーンは、これらを同時に発生させることを強制します。もしドキュメントを保存するたびに、会社の全員がレビューして承認するまで待たなければならないとしたらどうでしょうか。これがBitcoinやEthereumの動作方法で、全員が合意するまで何も一貫性を持てず、大きな遅延を生み出します。

**従来の問題：**
シングルスレッドブロックチェーンでは、この結合が悪循環を作り出します：
1. 新しいブロックが提案される
2. データが一貫性を持つ前にネットワークがコンセンサスに達しなければならない
3. ノードがコンセンサスプロセス中にデータを同期しようと慌てる
4. 各ステップで遅延の遅れが複合化される
5. 結果：確認の遅さとスループットの制限

**Quaiの革新：**
Quaiは階層構造を通じてこれらのプロセスを分離します：
- **ローカル一貫性**：ゾーンが自分のトランザクションについて即座に合意できる
- **段階的コンセンサス**：合意がローカルから地域、グローバルへと拡張される
- **待機なし**：ユーザーはグローバルコンセンサスがバックグラウンドで実行される間、即座にローカル確認を取得

**セキュリティ保証：**
この分離はセキュリティを損なうことはありません。Quaiはアトミックロールバックを維持します。グローバルコンセンサスがゾーンの状態を拒否する場合（極めて稀）、影響を受けるすべてのトランザクションが一緒に逆転します。これは、大幅なパフォーマンス向上を可能にしながら、二重支払いの可能性を防ぎます。

結果として、トランザクションが数秒でローカルに処理・確認され、グローバルコンセンサスのセキュリティ保証を維持するシステムが実現されます。これは、グローバル状態との同期が保証された高速ローカルキャッシュを持つようなものです。

## セグメント化状態：分割統治

従来のブロックチェーンでは、すべてのノードがすべてを保存する必要があります。すべてのトランザクション、すべてのアカウント残高、すべてのスマートコントラクト。これは、すべての図書館支店が図書館システム全体のすべての本を在庫する必要があるようなものです。これは大きな非効率性を生み出し、スケーラビリティを制限します。Quaiのセグメント化状態アーキテクチャは、このパラダイムを完全に変えます。

各ゾーンは、グローバル状態の自分のスライスのみを維持します。これは、会社の専門部門のようなものです。会計部門はエンジニアリングファイルを保存する必要がなく、その逆もありません。この専門化により、必要に応じて連携する能力を維持しながら要件を劇的に削減します。

**ストレージ効率：**
Nゾーンのネットワークでは：
- 従来のアプローチ：すべてのノードがグローバル状態の100%を保存
- Quaiアプローチ：各ゾーンノードは総状態の約1/Nのみを保存
- スライスノード：Pゾーンを実行することを選択でき、総状態のP/Nのみを保存

これは、ノードオペレータが劇的に低いハードウェア要件でネットワークに参加でき、分散化を向上させることを意味します。

**帯域幅最適化：**
セグメント化状態はネットワーク効率も革命化します：
- **ローカルトランザクション**：ゾーン内にとどまり、グローバルブロードキャストが不要
- **スマートルーティング**：データは必要な場所にのみ移動
- **渋滞削減**：各ゾーンがトラフィックを独立して処理

これは、会社のすべての電子メールがすべての従業員に送信される必要があるようなものです。これが従来のブロックチェーンの動作方法です。Quaiのアプローチは、部門別メーリングリストを持つようなもので、メッセージは関連する場所にのみ送信されます。

**迅速な一貫性：**
セグメント化アプローチにより、電光石火のローカル一貫性が可能になります：
1. ゾーントランザクションが即座にローカルコンセンサスを達成
2. ハッシュリンク参照がコンセンサススコープを段階的に拡張
3. グローバルコンセンサスがローカル操作を妨げることなく発生
4. ユーザーは最終的なグローバル最終性とともに即座の確認を体験

このアーキテクチャにより、Quaiはモノリシックブロックチェーン設計を悩ますボトルネックを排除することで、50,000+ TPSを処理できます。

## 並列処理：パフォーマンス乗数

マルチスレッド実行の真の力は、実際に動作を見ると明らかになります。従来のブロックチェーンがトランザクションを順次処理する（単一の行で一つずつ）のに対し、Quaiは複数のゾーンで並列処理します。これは、店舗の単一レジ係と複数のチェックアウトレーンが同時に動作することの違いです。

**技術的実装：**
Quaiは、各ゾーンに独自の独立したライトロックと計算リソースを与えることで真の並列処理を実現します。これは：
- ゾーンAがDeFiスワップを処理
- ゾーンBがNFTミントを処理
- ゾーンCがゲーミングトランザクションを実行
- すべてが干渉なしに同時に発生

**非同期ブロック生産：**
各ゾーンは他を待つことなく独自のスケジュールでブロックを生成します：
- グローバル同期遅延なし
- ゾーン間ボトルネックなし
- 計算リソースの最大活用

**50,000 TPSの現実：**
この並列アーキテクチャにより、Quaiはネットワーク全体で毎秒50,000トランザクション以上を達成できます。しかし、セキュリティや分散化を犠牲にする他の高TPS主張とは異なり、Quaiは以下を維持します：
- [PoEMコンセンサス](/jp/learn/advanced-introduction/poem/poem)による完全なアトミック性
- すべてのゾーンにわたる完全なセキュリティ
- アクセス可能なノード要件による真の分散化

**協調的独立性：**
システムの天才的な点は、ゾーンがパフォーマンスのために独立して動作する一方で、セキュリティのために協調したままであることです。問題が発生した場合（極めて稀）、PoEMコンセンサスがすべての影響を受けたゾーンが一緒にロールバックすることを保証し、ネットワーク全体の一貫性を維持します。

これは、統一されたコンセンサスのセキュリティと並列処理のパフォーマンスを併せ持つ、最高のマルチスレッドブロックチェーン実行です。