---
title: 分层结构
description: Quai网络分层结构的详细规范。
---

## 扩展性挑战

传统区块链面临着一个不可能的选择：保持小规模和安全，或者增长到大规模但变得脆弱。Quai的分层结构打破了这一局限。

**创新之处：**
想象一棵树，每个分支都独立处理交易，但主干确保所有分支保持安全。这就是Quai的分层结构——多个区块链"分支"并行工作，同时共享整个"树"的安全性。

## 工作原理

**三层组织结构：**
1. **主链**（主干）：协调整个网络
2. **区域链**（主要分支）：组织地理区域  
3. **区块链**（叶子）：处理您的实际交易

**关键突破：**
- **传统分片**：分割安全性（危险）
- **Quai方法**：仅分割工作负载（安全）

每个区块通过[合并挖矿](/cn/learn/advanced-introduction/merged-mining/overview)在保持整个网络完整安全性的同时独立处理交易。

## 为什么这很重要

**对用户而言：**
- **50,000+ TPS**：处理比Visa更多的交易
- **亚分手续费**：即使在大规模下也可持续
- **5秒区块**：接近即时的交易确认
- **全球规模**：为数十亿用户做好准备

**对网络而言：**
- **无限增长**：随着需求增加添加新区块
- **维持安全性**：每个区块都有完整的网络保护
- **优化性能**：矿工自我组织以获得最佳效率

## 安全创新

**传统分片问题：**
当区块链分割成分片时，每个分片通常只获得一小部分安全性。拥有10个分片的网络可能只给每个分片提供总安全性的10%——使它们容易受到攻击。

**Quai的解决方案：**
通过[合并挖矿](/cn/learn/advanced-introduction/merged-mining/overview)，每个区块中的每笔交易都获得网络100%的安全性。这在允许无限并行处理的同时维持了完整的基于哈希的安全保证。

## 自优化性能

**延迟问题：**
[网络延迟](/cn/learn/advanced-introduction/hierarchical-structure/latency)——数据在节点间传输所需的时间——是区块链性能的主要瓶颈。

**Quai的独特解决方案：**
矿工自然地为最佳性能组织自己，因为：
1. **更高延迟 = 更低利润**（更多叔块）
2. **矿工选择他们的区块**基于最佳连接
3. **结果**：无中央规划的地理自组织

**改进背后的数学：**

这种关系由 t = p*n*log_m(n) 描述，其中：
- **t** = 传播时间
- **p** = 节点间ping时间
- **n** = 网络中的节点数量
- **m** = 连接对等节点的平均数量

**现实世界示例：**
- **比特币**：8跳 × 100ms ping = 800ms总传播时间
- **Quai区块**：3跳 × 10ms ping = 30ms总传播时间
- **改进**：数据传播快25倍

这个自组织系统无需任何中央协调就创建了自然优化的区域网络。

## 并行处理能力

将Quai想象为[区块链的多核处理器](/cn/learn/advanced-introduction/multithreaded-execution)。每个区块链都像独立的CPU核心一样运行，并行处理交易同时保持完美同步。

**链如何协同工作：**
- **独立操作**：每个区块按自己的时间表产生区块
- **完美协调**：[哈希链接引用](/cn/learn/advanced-introduction/merged-mining/coincident-blocks)保持所有链同步
- **原子操作**：跨链交易要么完全完成，要么完全不执行

**三层架构：**

| 链类型 | 层次等级 | 网络算力百分比 | 区块时间† |
| ------ | -------- | -------------- | --------- |
| 主链   | 1（顶层） | 100%          | ~20秒     |
| 区域   | 2（中层） | ~33%          | ~10秒     |
| 区块   | 3（底层） | ~11%          | ~5秒      |

† _Quai网络中的区块产生是一个随机过程，意味着现实世界的区块时间会有轻微变化。这些时间是为2×2网络配置（2个区域，每个区域2个区块，总共4个区块）计算的。_

### 简单开始：单分片启动

**为什么从一个开始？**
Quai网络以单个区块链启动，因为添加不必要的分片会：
- **降低聚合安全性**：在不需要时分割算力
- **增加结算时间**：增加复杂性而无益处
- **浪费资源**：为未使用的容量运行基础设施

**自动扩展触发器：**
当持续需求导致叔块率在延长期间超过20%时，网络通过添加新分片自动扩展。这确保在增长的每个阶段都有最佳的安全性和性能。

### 主链：全球协调器

**目的**：作为网络的骨干，确保所有区域保持同步（当存在多个时）
- **安全性**：由100%的网络算力挖矿以获得最大安全性
- **功能**：纯协调——没有交易或账户
- **角色**：当网络扩展超过单分片时变为活跃

### 区域链：地理组织

**目的**：在地理区域内组织区块以获得最佳性能（在扩展期间激活）
- **安全性**：每个区域获得总算力的约1/N（其中N=区域数量）
- **功能**：协调其区域内的区块链
- **激活**：当网络需求触发扩展时创建

### 区块链：交易发生之处

**目的**：实际的工作马——处理所有用户交易
- **速度**：5秒平均区块时间以实现接近即时确认
- **功能**：唯一存储账户和处理交易的链
- **初始状态**：网络以一个区块链启动
- **扩展**：根据需求添加额外区块

每个区块作为独立的执行线程运行。随着网络增长，这创建了一个真正的[多线程区块链环境](/cn/learn/advanced-introduction/multithreaded-execution)。

## 跨链通信

**创新：**
通过[重合区块](/cn/learn/advanced-introduction/merged-mining/coincident-blocks)，Quai在网络中的所有链之间创建自然桥梁。这些哈希链接引用无需任何额外基础设施就能实现无信任的跨链交易。

**工作原理：**
- **自动创建**：合并挖矿自然产生这些连接
- **零开销**：矿工无需额外工作
- **无信任转移**：无需中介在链间移动资产
- **原子操作**：跨链交易完全完成或完全不执行

这代表了基于哈希的区块链之间第一个真正去中心化的桥梁，在整个网络中实现无缝互操作性。