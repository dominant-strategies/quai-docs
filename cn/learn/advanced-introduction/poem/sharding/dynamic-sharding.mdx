---
title: 动态分片
description: Quai Network 中动态扩展到更多分片的过程
---

## 自动网络扩展

想象一个高速公路系统，当交通拥堵时自动建造新车道。这本质上就是 Quai Network 通过动态分片所做的 - 当需求增加时自动添加处理能力。

**什么是动态分片？**
协议在网络拥堵时自动创建新的执行分片（处理通道），在无需人工干预或网络升级的情况下扩展容量。

**工作原理：**
1. **网络监控需求**：协议实时跟踪拥堵指标
2. **自动扩展**：当达到阈值时，创建新的区域和zone链
3. **无缝集成**：新链立即加入现有共识系统
4. **平衡增长**：所有区域获得额外zone以维护网络和谐

**关键优势：**
与其他需要硬分叉或在扩展时妥协安全性的区块链网络不同，Quai 在保持完全去中心化和安全性的同时自动添加容量。

<Frame>
	<img src='/images/DynamicSharding.jpg' />
</Frame>

## 网络如何知道何时扩展

协议监控两个关键拥堵指标来确定何时需要新容量：

### 1. 叔块率

**什么是叔块？**
将叔块想象为挖矿中的"交通堵塞"。当多个矿工同时找到有效区块时，只有一个成为主链的一部分 - 其他的成为"叔块"。

**为什么这很重要：**
- **高叔块率** = 网络拥堵（太多矿工竞争有限空间）
- **效率降低** = 浪费挖矿能量和较慢的交易终结性
- **明确信号** = 是时候添加更多容量了

**Quai 如何响应：**
当叔块持续超过阈值比率时，协议自动：
1. 创建新的区域和zone链
2. 将它们集成到全球共识中
3. 在更多链上分配挖矿算力
4. 减少拥堵并恢复效率

**结果**：保持高哈希效率，保持快速终结性

### 2. Gas 限制利用率

**什么是 Gas 限制？**
每个区块都有最大计算容量（gas限制）。当区块持续达到此限制时，意味着需求超过供应。

**其他网络中的费用问题：**
- **以太坊示例**：当区块满时，费用可能达到每笔交易50美元以上
- **竞价战**：用户通过支付更高费用竞争有限的区块空间
- **用户体验**：交易变得昂贵且不可预测

**Quai 的解决方案：**
当区块持续达到其gas限制时，协议自动添加新的执行分片，确保：
- **费用保持在0.01美元以下**：增加的容量消除了费用竞争
- **没有竞价战**：总是有足够的区块空间满足需求
- **可预测成本**：用户知道交易费用将保持可负担

**结果**：无限可扩展性，不妥协可负担性

## 唯一权衡：结算时间

**网络扩展如何工作：**
- **3×3 开始**：3个区域，每个3个zone = 总共9个zone
- **首次扩展**：4×4布局 = 总共16个zone
- **增长模式**：5×5, 6×6, 7×7... 无限扩展

**权衡是什么？**
添加容量的唯一成本是增加**全球结算时间** - 但这不影响交易安全性或可用性。

## 结算 vs 终结性：为什么这很重要

**关键区别：**
- **终结性**：你的交易何时永久且安全（Quai中为秒）
- **结算**：资金何时可以跨链使用（分钟到小时）

**现实世界影响：**
- ✅ **你的交易是安全的** 在终结性后立即
- ✅ **接收者可以信任付款** 无需等待结算
- ⏳ **跨链支出** 需要结算完成

**示例时间线：**
1. **10秒**：交易终结（安全且永久）
2. **3,300秒**：全球结算（可以在其他区域使用资金）

**为什么这种设计有效：**
大多数交易发生在同一区域内，结算很快。跨链操作不太频繁，用户可以相应计划。

## 结算时间计算

**公式：**
全球（prime）结算的平均时间可以通过以下方程测量，其中：

- **TSₚ** = 全球（prime）结算的平均时间（秒）
- **nz** = 每个区域的zone数量
- **nr** = 系统中的区域数量
- **tz** = Zone区块时间（秒）= 5

$$
TS_{p} = n_{z}^2 * n_{r}^2 * t_{z}
$$

**这意味着什么：**
- 结算时间随区域数量和每个区域zone数量的平方增加
- **5秒**：Zone区块时间（大多数交易发生的地方）
- **总时间**：随网络规模可预测地扩展

<br></br>
<br></br>

| 区域数量 | 每个区域Zone数量 | 总Zone数 | 全球结算时间† |
| -------- | ---------------- | --------- | -------------- |
| 3        | 3                | 9         | 405秒          |
| 4        | 4                | 16        | 1,280秒        |
| 5        | 5                | 25        | 3,125秒        |
| 6        | 6                | 36        | 6,480秒        |
| 7        | 7                | 49        | 12,005秒       |
| 8        | 8                | 64        | 20,480秒       |

**重要说明：**
- 结算时间是**平均值** - 由于挖矿的随机性，实际时间会有所不同
- **~50%的交易** 比平均时间更快结算
- **所有交易** 在结算完成之前就是最终且安全的

**理解分布：**
下面的图表显示跨链交易时间如何分布。虽然平均全球结算是3,300秒，但一半的交易完成得比这更快。

<Frame>
	<img src='/images/Cross-PrimeTransactions.png' />
</Frame>