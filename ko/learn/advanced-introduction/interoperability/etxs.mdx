---
title: 외부 트랜잭션 (ETX)
description: Quai 네트워크에서 크로스체인 트랜잭션이 처리되는 방법을 알아보세요.
---

## 외부 트랜잭션 이해하기

대부분의 블록체인 네트워크에서 체인 간 자산 이동은 래핑된 토큰, 브리지 운영자, 그리고 상당한 신뢰 가정을 포함하는 복잡한 과정입니다. 사용자들은 종종 브리지 해킹으로 자금을 잃거나, 긴 지연을 경험하거나, 과도한 수수료를 지불합니다. Quai 네트워크의 외부 트랜잭션(ETX)은 블록체인이 소통할 수 있는 방법에 대한 근본적인 재구상을 나타냅니다.

ETX는 외부 의존성 없이 Quai 존 간에 가치를 이동시키는 네이티브 크로스체인 트랜잭션입니다. 이러한 트랜잭션들은 모든 체인을 동기화된 상태로 유지하는 동일한 해시 링크된 참조를 활용하여, 일반적인 온체인 전송만큼 안전하게 만듭니다. 브리지 운영자도, 래핑된 토큰도, 신뢰 가정도 없습니다 - 순수한 암호학적 보장만 있을 뿐입니다.

**ETX의 여행:**
모든 ETX는 Quai의 계층구조를 통해 결정론적 경로를 따릅니다. 강 시스템을 통해 흐르는 물처럼, 트랜잭션들은 항상 합류점(지배 체인)으로 올라간 다음 목적지로 다시 내려갑니다. 이 예측 가능한 라우팅은 효율성을 유지하면서 보안을 보장합니다.

ETX는 항상 계층구조의 지배 체인을 통과하며, 이는 리전 체인이나 프라임 체인일 수 있습니다. 다음 다이어그램들은 이 두 가지 라우팅 패턴을 보여줍니다:

<Frame>
	<img src='/images/Cross-Prime-TXNS.png' />
</Frame>

<Frame>
	<img src='/images/Cross-Region-TXNS.png' />
</Frame>

## ETX가 네트워크를 탐색하는 방법

ETX가 Quai의 계층구조를 통해 이동하는 방법을 이해하는 것은 개발자와 사용자 모두에게 중요합니다. 시스템은 안전하고 효율적이도록 설계되어, 네트워크에 병목현상을 만들지 않으면서 크로스체인 전송이 안정적으로 완료되도록 보장합니다.

각 ETX는 "출발 체인"이라고 부르는 곳에서 여행을 시작합니다 - 트랜잭션이 시작된 존입니다. 최종 목적지는 적절히 "목적지 체인"이라고 불립니다. 이 두 지점 사이에서, 트랜잭션은 특정 경로를 따릅니다: 계층구조를 통해 공유된 지배 체인까지 올라간 다음, 목적지로 다시 내려갑니다. 이 라우팅은 목적지 주소에 기반하여 자동으로 발생합니다.

**두 가지 유형의 크로스체인 운영:**
Quai는 각각 다른 사용 사례를 제공하는 두 가지 서로 다른 유형의 ETX를 지원합니다:
1. **계정 시작 ETX**: 일반 사용자가 존 간에 자산을 보내는 것
2. **컨트랙트 시작 ETX**: 스마트 컨트랙트가 프로그래밍적으로 크로스체인 운영을 트리거하는 것

**혁신을 통한 효율성:**
전통적인 크로스체인 시스템들은 각 트랜잭션을 개별적으로 처리하여, 상당한 오버헤드를 만듭니다. Quai는 블록 헤더에서 ETX 데이터를 배치하는 혁신적인 롤업 메커니즘을 구현합니다. 이 전방 전파 시스템은 처리 요구사항을 30배 이상 줄여, 네트워크가 혼잡 없이 대규모 크로스체인 볼륨을 처리할 수 있게 합니다. 각 배송마다 개별 보트를 보내는 대신 많은 패키지를 운반하는 화물선과 같다고 생각해보세요.

## 계정 시작 ETX: 사용자 전송

계정 시작 ETX는 가장 일반적인 유형의 크로스체인 트랜잭션을 나타냅니다 - 사용자가 존 간에 자산을 이동시키는 것입니다. 이러한 트랜잭션들은 합리적인 속도를 유지하면서 보안을 보장하는 예측 가능한 2단계 과정을 따릅니다. 이 과정을 이해하면 사용자들이 크로스체인 전송에 대한 적절한 기대치를 설정하는 데 도움이 됩니다.

여행은 사용자가 다른 존의 주소로 전송을 시작할 때 시작됩니다. 네트워크는 목적지 주소 형식에 기반하여 이를 크로스체인 운영으로 자동 인식하고 ETX 과정을 시작합니다. 사용자 관점에서는 단순히 수신자 주소와 금액을 지정하기만 하면 됩니다 - 복잡성은 프로토콜이 완전히 처리합니다.

### 1단계: 계층구조 위로 이동

첫 번째 단계는 목적지 존과 조정할 수 있는 체인에 도달할 때까지 트랜잭션 데이터를 네트워크 계층구조를 통해 위로 이동시키는 것입니다. 이 상향 전파는 다음 단계들을 따릅니다:

1. **초기 브로드캐스트**: 트랜잭션이 표준 내부 트랜잭션으로 출발 존에 제출됩니다
2. **로컬 처리**: 출발 존의 마이너들이 트랜잭션을 블록에 포함시켜, 발신자에서 잔액을 제거하고 하나 이상의 ETX를 생성합니다
3. **상향 전파**: ETX 데이터가 계층구조의 지배 체인들로 전달됩니다
4. **일치 블록 수집**: 일치 블록이 발생하면, 지배 체인들이 하위 존들로부터 모든 대기 중인 ETX를 수집합니다
5. **지속적인 상승**: 목적지가 더 높은 체인(프라임처럼)을 통한 조정을 요구하는 경우, 과정이 위쪽으로 반복됩니다

### 2단계: 객관적 정규화 및 전달

ETX가 조정 지점에 도달하면, 객관적 정규화의 중요한 과정이 시작됩니다. 이 단계는 Quai의 해시 링크된 참조 시스템을 활용하여 유효하고 정규적인 ETX만 실행되도록 보장합니다:

1. **해시 링크된 참조 생성**: 일치 블록이 발견되면, 같은 위치에서 마지막 일치 블록 이후 각 블록의 하위 매니페스트에서 각 해시로부터 대기 중인 ETX가 수집됩니다
2. **객관적 정규화**: 현재 체인이나 하위 체인들을 위한 모든 ETX가 식별되고 이러한 객관적 해시 링크된 증명을 통해 참조 가능해집니다
3. **사전 계산된 상태 전파**: 정규화된 ETX들이 목적지 체인으로 전파되어, 대기 중인 ETX 세트에 추가되고 마이닝에 사용 가능해집니다
4. **증명과 함께 최종 실행**: ETX는 객관적 해시 참조가 방출된 ETX의 정규화를 증명한 후에만 목적지 체인의 블록에 포함되어, 수신 주소에 잔액을 추가합니다

이 과정은 모든 크로스체인 전송이 신뢰 기반 가정이 아닌 유효성의 수학적 증명과 함께 로컬 트랜잭션과 동일한 보안 보장을 유지하도록 보장합니다. 전체 과정은 일반적으로 암호학적 확실성을 제공하면서 몇 분 내에 완료됩니다.

## 컨트랙트 시작 ETX: 스마트 컨트랙트 상호작용

컨트랙트 시작 ETX는 스마트 컨트랙트가 프로그래밍적으로 크로스체인 운영을 트리거할 수 있게 하여, 정교한 멀티체인 애플리케이션을 가능하게 합니다. 이 과정은 보안을 보장하는 동일한 객관적 해시 링크된 참조 시스템을 활용하지만, 크로스체인 운영이 언제 필요한지 결정하는 스마트 컨트랙트 로직을 추가합니다.

### 1단계: 스마트 컨트랙트 로직 및 상향 전파

스마트 컨트랙트들은 특화된 오프코드를 사용하여 크로스체인 결정을 내리고 필요시 ETX를 방출합니다:

1. **컨트랙트 상호작용 시작**: 사용자가 컨트랙트 함수를 호출하여, 잠재적으로 주소 지역성을 확인하는 ISADDRINTERNAL 편의 오프코드를 트리거합니다
2. **크로스체인 결정**: ISADDRINTERNAL이 FALSE(크로스체인 주소를 나타냄)를 반환하거나 다른 컨트랙트 로직이 트리거되면, 컨트랙트가 OP_ETX를 사용하여 ETX를 방출합니다
3. **계층적 전파**: ETX들이 계층구조의 지배 피어들로 전파됩니다
4. **일치 블록 수집**: 일치 블록이 발견되면, 지배 피어들이 하위 매니페스트 연결을 통해 모든 대기 중인 ETX를 수집합니다
5. **지속적인 상승**: 목적지 체인이 지배 체인을 가지는 경우(즉, 리전 체인인 경우), 3단계와 4단계가 위쪽으로 반복됩니다

### 2단계: 객관적 정규화 및 실행

하향 단계는 ETX 유효성을 보장하기 위한 Quai의 독특한 객관적 해시 참조 시스템에 의존합니다:

1. **해시 링크된 참조 생성**: 일치 블록이 발생하면, 마지막 일치 블록 이후 각 블록의 하위 매니페스트에서 각 해시로부터 대기 중인 ETX가 수집됩니다
2. **객관적 정규화**: 현재 체인이나 하위 체인들을 위한 ETX가 식별되고 이러한 해시 링크된 증명을 통해 참조 가능해집니다
3. **사전 계산된 상태 가용성**: 대기 중인 ETX들이 목적지 체인으로 전파되고 대기 중인 ETX 세트에 추가되어, 마이닝에 사용 가능해집니다
4. **증명과 함께 최종 실행**: ETX는 객관적 해시 참조가 방출된 ETX의 정규화를 증명한 후에만 목적지 체인 블록에 포함됩니다

이 시스템은 컨트랙트 시작 크로스체인 운영이 복잡한 멀티체인 애플리케이션 로직을 가능하게 하면서 로컬 트랜잭션과 동일한 보안 보장을 유지하도록 보장합니다.

## ETX 롤업의 전방 전파

Quai의 핵심 혁신 중 하나는 대량의 크로스체인 트랜잭션을 처리하는 효율성입니다. 전통적인 시스템들은 각 크로스체인 운영을 개별적으로 처리하여, 상당한 계산 오버헤드를 만듭니다. Quai는 ETX 데이터를 배치하고 사전 처리하는 정교한 롤업 메커니즘을 구현하여, 보안을 유지하면서 계산 요구사항을 30배 이상 줄입니다.

**블록 헤더 데이터 필드:**
각 Quai 블록 헤더에는 ETX 관리를 위한 두 개의 특화된 필드가 포함됩니다:
- **etxTransactions**: 해시 목록으로, 각 해시는 해당 특정 블록에서 방출된 고유한 ETX를 나타냅니다
- **etxRollupRoot**: 이전 일치 블록 이후 방출된 모든 ETX의 누적 롤업을 나타내는 단일 해시입니다

**사전 계산된 상태 전환:**
etxRollupRoot 필드는 각 로컬 합의 지점에서 조정 블록체인으로 전파되어, 목적지 체인들이 ETX가 정규화되기 전에 상태 전환을 사전 계산할 수 있게 합니다. 이 준비는 ETX가 결국 실행을 위해 도착할 때 처리 시간을 극적으로 줄입니다.

**중요한 보안 제약:**
사전 계산된 상태 전환이 출발지와 목적지 체인 간의 객관적 해시 링크된 참조가 제공될 때까지 참조 가능하거나 정규화되지 않는다는 것을 이해하는 것이 중요합니다. 이는 정규적인 ETX만이 체인 상태에 영향을 줄 수 있도록 보장하여, 유효하지 않거나 사기성 크로스체인 운영의 가능성을 방지합니다.

**하위 블록 매니페스트:**
해시 링크된 참조는 하위 블록 매니페스트(subManifest)라고 불리는 특화된 데이터 필드를 통해 생성됩니다. 이 필드는 일반 블록에서는 비어있지만 일치 블록에서는 중요해지며, 이전 일치 블록 이후 생성된 모든 하위 블록 해시의 완전한 목록을 포함합니다. 이는 각 지배 블록체인 내의 모든 하위 블록에 대한 직접적이고 객관적인 참조를 만들어, 전체 Quai 네트워크를 보호하는 해시 링크된 참조를 확립합니다.

사전 계산된 전환 세트를 받은 조정 컨텍스트에 해시 링크된 참조가 제공되는 순간, ETX는 정규적으로 검증 가능해지고 상태 전환이 참조 가능하고 실행 가능해집니다. 이 시스템은 크로스체인 운영을 위한 효율성과 보안의 완벽한 균형을 제공합니다.