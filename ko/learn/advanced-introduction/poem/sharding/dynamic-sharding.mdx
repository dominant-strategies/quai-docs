---
title: 동적 샤딩
description: Quai Network에서 더 많은 샤드로 동적으로 확장하는 과정.
---

## 자동 네트워크 확장

트래픽이 많아질 때 자동으로 새로운 차선을 건설하는 고속도로 시스템을 상상해보세요. 이것이 본질적으로 Quai Network가 동적 샤딩으로 하는 일입니다 - 수요가 증가할 때 자동으로 처리 용량을 추가합니다.

**동적 샤딩이란 무엇인가?**
프로토콜이 네트워크가 혼잡해질 때 자동으로 새로운 실행 샤드(처리 채널)를 생성하여 인간의 개입이나 네트워크 업그레이드 없이 용량을 확장합니다.

**작동 방식:**
1. **네트워크가 수요를 모니터링**: 프로토콜이 실시간으로 혼잡 지표를 추적합니다
2. **자동 확장**: 임계값이 충족되면 새로운 리전과 존 체인이 생성됩니다
3. **원활한 통합**: 새로운 체인이 즉시 기존 합의 시스템에 합류합니다
4. **균형잡힌 성장**: 모든 리전이 추가 존을 얻어 네트워크 조화를 유지합니다

**핵심 장점:**
확장할 때 하드 포크가 필요하거나 보안을 타협하는 다른 블록체인 네트워크와 달리, Quai는 완전한 탈중앙화와 보안을 유지하면서 자동으로 용량을 추가합니다.

<Frame>
	<img src='/images/DynamicSharding.jpg' />
</Frame>

## 네트워크가 언제 확장할지 아는 방법

프로토콜은 새로운 용량이 필요한 시점을 결정하기 위해 두 가지 주요 혼잡 지표를 모니터링합니다:

### 1. 엉클 블록 비율

**엉클 블록이란 무엇인가?**
엉클 블록을 채굴의 "교통 체증"으로 생각해보세요. 여러 채굴자가 동시에 유효한 블록을 찾을 때, 하나만 메인 체인의 일부가 되고 나머지는 "엉클"이 됩니다.

**이것이 중요한 이유:**
- **높은 엉클 비율** = 네트워크 혼잡 (제한된 공간을 위해 경쟁하는 채굴자가 너무 많음)
- **효율성 감소** = 채굴 에너지 낭비와 거래 최종성 지연
- **명확한 신호** = 더 많은 용량을 추가할 시간

**Quai의 대응:**
엉클 블록이 지속적으로 임계값 비율을 초과하면, 프로토콜이 자동으로:
1. 새로운 리전과 존 체인을 생성합니다
2. 전역 합의에 통합합니다
3. 더 많은 체인에 채굴 능력을 분산시킵니다
4. 혼잡을 줄이고 효율성을 복원합니다

**결과**: 높은 해시 효율성 유지, 빠른 최종성 보존

### 2. 가스 한도 사용률

**가스 한도란 무엇인가?**
각 블록은 최대 계산 용량(가스 한도)을 가집니다. 블록이 지속적으로 이 한도에 도달할 때, 이는 수요가 공급을 초과한다는 것을 의미합니다.

**다른 네트워크의 수수료 문제:**
- **이더리움 예시**: 블록이 가득 찰 때, 수수료가 거래당 $50 이상에 도달할 수 있습니다
- **입찰 전쟁**: 사용자들이 제한된 블록 공간을 위해 더 높은 수수료를 지불하며 경쟁합니다
- **사용자 경험**: 거래가 비싸지고 예측 불가능해집니다

**Quai의 해결책:**
블록이 지속적으로 가스 한도에 도달할 때, 프로토콜이 자동으로 새로운 실행 샤드를 추가하여 다음을 보장합니다:
- **수수료가 $0.01 미만 유지**: 증가된 용량이 수수료 경쟁을 제거합니다
- **입찰 전쟁 없음**: 수요를 충족할 충분한 블록 공간이 항상 있습니다
- **예측 가능한 비용**: 사용자가 거래 수수료가 저렴하게 유지될 것임을 알 수 있습니다

**결과**: 경제성을 타협하지 않고 무제한 확장성

## 유일한 트레이드오프: 정산 시간

**네트워크 확장 작동 방식:**
- **3×3 시작**: 3개 리전, 각각 3개 존 = 총 9개 존
- **첫 번째 확장**: 4×4 레이아웃 = 총 16개 존  
- **성장 패턴**: 5×5, 6×6, 7×7... 무제한 확장

**트레이드오프는 무엇인가?**
용량 추가의 유일한 비용은 **전역 정산 시간** 증가입니다 - 하지만 이는 거래 안전성이나 사용성에 영향을 미치지 않습니다.

## 정산 대 최종성: 이것이 중요한 이유

**중요한 구별:**
- **최종성**: 거래가 영구적이고 안전한 시점 (Quai에서 몇 초)
- **정산**: 자금을 체인 간에 사용할 수 있는 시점 (몇 분에서 몇 시간)

**실제 영향:**
- ✅ **거래가 안전함** 최종성 후 즉시
- ✅ **수령자가 결제를 신뢰할 수 있음** 정산을 기다리지 않고  
- ⏳ **체인 간 지출**은 정산 완료가 필요함

**예시 타임라인:**
1. **10초**: 거래 최종화 (안전하고 영구적)
2. **3,300초**: 전역 정산 (다른 리전에서 자금 사용 가능)

**이 설계가 작동하는 이유:**
대부분의 거래는 정산이 빠른 동일한 리전 내에서 발생합니다. 체인 간 작업은 덜 빈번하며 사용자가 그에 따라 계획할 수 있습니다.

## 정산 시간 계산

**공식:**
전역(프라임) 정산까지의 평균 시간은 다음 방정식으로 측정할 수 있습니다:

- **TSₚ** = 전역(프라임) 정산까지의 평균 시간 (초 단위)
- **nz** = 리전당 존의 수
- **nr** = 시스템의 리전 수
- **tz** = 존 블록 시간 (초 단위) = 5

$$
TS_{p} = n_{z}^2 * n_{r}^2 * t_{z}
$$

**이것이 의미하는 것:**
- 정산 시간은 리전 수와 리전당 존 수의 제곱으로 증가합니다
- **5초**: 존 블록 시간 (대부분의 거래가 발생하는 곳)
- **총 시간**: 네트워크 크기에 따라 예측 가능하게 확장됩니다

<br></br>
<br></br>

| 리전 수 | 리전당 존 수 | 총 존 수 | 전역 정산 시간† |
| ----------------- | -------------------------- | ----------- | -------------------------- |
| 3                 | 3                          | 9           | 405초                       |
| 4                 | 4                          | 16          | 1,280초                     |
| 5                 | 5                          | 25          | 3,125초                     |
| 6                 | 6                          | 36          | 6,480초                     |
| 7                 | 7                          | 49          | 12,005초                    |
| 8                 | 8                          | 64          | 20,480초                    |

**중요한 참고사항:**
- 정산 시간은 **평균**입니다 - 채굴의 무작위적 특성으로 인해 실제 시간은 다릅니다
- **거래의 ~50%**가 평균 시간보다 빠르게 정산됩니다
- **모든 거래**는 정산이 완료되기 훨씬 전에 최종적이고 안전합니다

**분포 이해:**
아래 다이어그램은 체인 간 거래 시간이 어떻게 분포되는지 보여줍니다. 평균 전역 정산이 3,300초이지만, 거래의 절반은 이보다 빠르게 완료됩니다.

<Frame>
	<img src='/images/Cross-PrimeTransactions.png' />
</Frame>