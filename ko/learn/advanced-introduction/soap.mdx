---

title: 프로젝트 SOAP
description: Quai가 보조금 기반 공개시장 매입 프로토콜(SOAP)을 통해 머지 마이닝을 토큰 바이백으로 전환하는 방식
------------------------------------------

비트코인 채굴자들은 하나의 체인에 하드웨어를 겨냥하고, 블록을 풀어 보상을 얻기 위해 경쟁합니다. 그런데 같은 하드웨어를 여러 체인에 동시에 겨냥해 두 체인 모두에서 보상을 받을 수 있다면 어떨까요? 이것이 바로 머지 마이닝(merge-mining)의 핵심 아이디어입니다. 머지 마이닝은 계산력을 나누지 않고도 두 개 이상 블록체인을 동시에 채굴해 보상을 얻을 수 있게 해주는 기술입니다.

가장 유명한 사례는 2011년부터 비트코인과 머지 마이닝된 네임코인(Namecoin)입니다. 아이디어는 우아합니다. 비트코인을 채굴할 때, 비트코인 블록의 코인베이스(coinbase) 트랜잭션에 네임코인 블록에 대한 참조를 포함합니다. 비트코인 블록이 유효하면 네임코인 블록 보상도 함께 청구할 수 있습니다. 즉 하나의 작업증명 연산을 수행하지만, 두 체인에서 동시에 크레딧을 얻는 셈이죠.

이후 라이트코인(Litecoin)과 도지코인(Dogecoin)은 더 정교한 버전을 도입해 DOGE 채굴자들이 LTC를 동시에 채굴할 수 있게 했습니다. 그 결과 공생 관계가 형성되었습니다. 도지코인은 라이트코인의 해시레이트로부터 보안을 얻고, 라이트코인 채굴자들은 DOGE 보상으로 추가 수익을 얻었습니다.

하지만 SOAP을 촉발한 기회는 여기 있습니다. 전통적 머지 마이닝에서는 채굴자가 부모 체인(예: 비트코인 캐시)과 자식 체인(예: 네임코인)의 블록 보상을 모두 직접 자신의 지갑으로 받습니다. 이는 자식 체인이 보안을 위해 채굴자에게 비용을 지불하는 구조인데, 채굴자들이 자식 체인의 토큰을 즉시 매도하기 때문에 지속적인 매도 압력을 유발합니다.

그 흐름을 “영구적인 프로토콜 지원”으로 바꿀 수 있다면 어떨까요?

## SOAP 보조금(서브시디) 모델

SOAP은 머지 마이닝을 프로토콜 보조금 메커니즘으로 변환합니다. 채굴자가 부모 체인의 블록 보상을 직접 받는 대신, SOAP은 부모 체인의 코인베이스 출력 100%를 프로토콜이 제어하는 주소로 라우팅합니다. 그 주소는 시장에서 부모 체인 토큰을 QUAI로 교환하고, 구매한 QUAI를 소각(burn)하거나 타임락된 스테이킹 보상으로 보냅니다.

이렇게 보면 됩니다. SOAP을 켜고 QUAI를 채굴하면, 평소처럼 QUAI 블록 보상을 그대로 받습니다. SOAP은 이를 바꾸지 않습니다. SOAP이 추가하는 것은 다른 체인(BCH, LTC, DOGE, RVN)의 해시레이트를 workshare/블록 형태로 기여해 프로토콜 보조금을 만들 수 있는 능력입니다. 참여 인센티브는 간단합니다. QUAI를 채굴하고 QUAI로 보상을 받되, 부모 체인 블록 보조금은 프로토콜로 귀속됩니다.

<Frame>
	<img src='/images/SOAP/SOAPFlows.png' />
</Frame>

QUAI에만 집중하는 채굴자에게는 아무것도 달라지지 않습니다. 그들은 KawPow 블록을 채굴하고 QUAI를 얻습니다. 반면 이미 BCH/LTC/DOGE 하드웨어를 보유한 채굴자에게 SOAP은 QUAI를 벌 새로운 길을 제공합니다. SHA-256 또는 Scrypt 장비를 SOAP 지원 풀에 연결해 QUAI를 채굴하면, 머지 마이닝된 BCH/LTC/DOGE는 바이백 자금으로 사용됩니다.

핵심 인사이트는 이겁니다. SOAP은 유효한 부모 체인 머지 마이닝을 자동으로 포함해 지속적인 프로토콜 보조금을 생성합니다. 채굴자들은 가지고 있는 어떤 하드웨어로든 보안에 기여하고, 프로토콜은 그에 대한 대가를 QUAI로 공정하게 지급하면서 부모 체인 보조금을 영구적인 매수 압력으로 전환합니다.

최악의 경우 이는 일일 순흐름 0에 가깝습니다. 채굴자들이 QUAI를 매도하면, 프로토콜이 부모 체인 보조금으로 QUAI를 매수해 상쇄됩니다. 하지만 실제로는 “비용병적(non-mercenary)” 채굴자(즉시 던지지 않고 보유하는 주체)가 존재해 대부분의 날에 순매수 압력이 생깁니다. 더 많은 보조금 기반 매수 → 가격 개선 → 더 많은 해시레이트 → 더 강한 QUAI 보안 → 보조금 체인 입장에서 더 매력적인 SOAP 참여 → 더 많은 보조금 유입 → 더 많은 매수·소각으로 이어지는 선순환이 가능합니다.

<Frame>
	<img src='/images/SOAP/SOAPInAction.png' />
</Frame>

**중요 참고:** 이는 약속이 아니라, 그럴듯한 긍정적 피드백 루프에 대한 가설일 뿐입니다.

## 기술 구조: AuxPoW

Quai는 어떻게 부모 체인 블록이 실제로 프로토콜 주소로 지급했고 필요한 커밋먼트를 포함했는지 검증할까요? AuxPoW(보조 작업증명, auxiliary proof-of-work) 구조를 통해서입니다.

AuxPoW는 SPV 스타일의 증명으로, 다음을 포함합니다:

* 부모 체인의 80바이트 블록 헤더(KawPow는 120바이트)
* 해당 블록의 코인베이스 트랜잭션
* 코인베이스가 블록에 포함되었음을 증명하는 머클 브랜치
* 어느 부모 체인에서 왔는지를 식별하는 메타데이터(BCH, LTC, DOGE, KawPow 등)

Quai 노드가 AuxPoW 구조가 포함된 블록을 받으면 다음을 검사합니다:

* **머클 검증:** 코인베이스 트랜잭션이 부모 체인 블록의 머클 루트에 실제로 포함되는가?
* **커밋먼트 검사:** 코인베이스 scriptSig에 SOAP push가 들어있는가? (구체적으로 매직 바이트 "SOAP"의 0x01 뒤에 32바이트 Quai WorkObject 해시)
* **지급 검사:** 코인베이스의 첫 번째 출력이 보조금+수수료의 100%를 프로토콜 지정 주소(QADDR)로 지급하는가?
* **(선택) PoW 검증:** 부모 체인 헤더가 해당 체인의 난이도 타깃을 만족하는가?

SOAP 커밋먼트는 코인베이스 scriptSig 안, BIP34 높이 push 직후에 들어갑니다. 이 위치가 중요한 이유는 scriptSig가 채굴자가 블록을 만들 때 구성하는 코인베이스 트랜잭션의 일부이며, OP_RETURN 처리나 정책 변동 걱정 없이 모든 SOAP 체인에서 보편적으로 사용 가능하기 때문입니다.

커밋먼트 형식은 최소화되어 있습니다:

* PUSHDATA(BIP34_height)
* PUSHDATA("SOAP" 0x01 || 32바이트 WO_HASH)
* PUSHDATA(extranonce1)
* PUSHDATA(extranonce2)

채굴자는 extranonce2를 평소처럼 변화시키고, 풀은 extranonce1을 제공하며, SOAP push는 풀의 작업 템플릿으로 고정됩니다. 따라서 표준 Stratum v1 채굴이 펌웨어 변경 없이 작동합니다. 풀은 workshare 보상을 받을 QUAI 지급 주소를 지정하고, 부모 체인 코인베이스 구성(QADDR 지급 및 SOAP 커밋먼트 포함)은 Quai 노드가 처리합니다.

<Frame>
	<img src='/images/SOAP/QuaiPools.png' />
</Frame>

## Workshare와 다중 알고리즘 채굴

여기서 SOAP은 프로토콜 설계 관점에서 흥미로워집니다. Quai 블록은 오직 KawPow 채굴자만 작성할 수 있습니다. 다른 알고리즘은 Quai 블록을 만들 수 없습니다. 하지만 다른 알고리즘(BCH의 SHA-256, LTC/DOGE의 Scrypt, 그리고 KawPow 자체)은 workshare를 제출해 KawPow 블록에 포함될 수 있고 QUAI 보상을 얻습니다.

Quai가 workshare를 처음 만든 목적은 셀피시 마이닝을 방지하고 더 빠른 파이널리티 수렴을 위한 해시레이트 샘플을 제공하기 위함이었지만, 그 메커니즘은 자연스럽게 KawPow 이외의 PoW 알고리즘을 지원하도록 확장됩니다.

비트코인의 인센티브 정렬 관점에서 핵심 문제는 “블록 생산만 관측할 수 있고 해시 시도를 관측할 수 없을 때 채굴자 보상을 어떻게 작업량에 비례시킬 것인가?”입니다. 모든 nonce 시도를 제출하게 하는 것은 비용이 너무 큽니다. 채굴 풀은 쉬운 난이도의 k-서브블록(share)을 제출하게 하고 share 수로 보상하는 방식으로 이를 해결합니다.

Quai는 이 아이디어를 workshare로 온체인화합니다. 다만 전통적 풀의 오프체인 share와 달리 Quai workshare는 다음 조건을 만족하는 WorkObject입니다:

* Quai의 블록 난이도 타깃을 **만족하지 않음**(KawPow 블록이 아님)
* 부모 체인 참여를 증명하는 유효한 AuxPoW를 **포함함**
* WorkObject의 parentHash로 현재 Quai tip에 **커밋함**

각 workshare는 “나는 체인 X(BCH/LTC/DOGE/RVN)에서 계산을 수행했고, Quai WorkObject Y를 참조했으며, 부모 체인 블록이 QADDR로 지급했다”는 사실을 증명합니다. workshare는 새 Quai 블록을 만들지는 않지만, WorkObject의 primaryCoinbase 필드에 지정된 주소로 QUAI 지급을 발생시킵니다.

KawPow 블록 생산자는 블록당 최대 9개의 workshare를 포함할 수 있으며(하드 캡), 별도의 난이도 조정 알고리즘으로 블록당 약 3개의 soft 타깃을 유지합니다. 각 알고리즘(SHA-256, Scrypt, KawPow)은 자체 share 난이도 타깃을 가져 한 알고리즘이 과도하게 지배하지 못하게 합니다.

이 다중 알고리즘 접근은 두 가지 이점을 제공합니다:

* **하드웨어 다양성:** 서로 다른 알고리즘 ASIC이 서로 다른 공급망 기반으로 보안에 기여해 특정 제조사/하드웨어 클래스의 지배를 어렵게 합니다.
* **보조금 전환의 확장성:** KawPow 블록이 목표 속도로 이미 생산되고 있어도, workshare를 통해 Quai의 블록 타이밍/난이도를 흔들지 않고 부모 체인 참여 규모를 계속 늘릴 수 있습니다.

## Workshare는 가중치를 더하고 보안을 제공한다

workshare는 Quai 합의에서 블록 가중치와 경제적 파이널리티에 직접 기여합니다. 블록 가중치는 단순한 블록 개수가 아니라 체인을 보호하는 총 계산 작업량을 반영하는 엔트로피 측정치입니다. 이 엔트로피는 PoEM과 비례 보상 분할(PRS)을 통해 측정되며, SOAP 이전부터 Quai에 존재했습니다.

블록의 총 엔트로피(가중치)를 계산할 때 프로토콜은:

* PoW 해로부터 블록 자체 엔트로피를 계산하고
* 포함된 모든 workshare의 엔트로피를 더한 뒤(블록당 최대 9개)
* 할인 규칙을 적용합니다:

  * 블록 난이도 임계값 이하 workshare는 감소된 가중치를 받음
  * 더 오래된 블록을 가리키는 workshare는 거리 기반으로 지수적으로 할인됨

SHA-256와 Scrypt workshare를 포함한 KawPow 블록은 포함하지 않은 동일 KawPow 블록보다 측정 가능한 추가 가중치를 갖습니다. 이 추가 가중치는 재구성을 더 어렵게 만들고 경제적 파이널리티를 더 빠르게 합니다.

경제적 파이널리티는 재구성 비용에 달려 있습니다. 공격자는 정직한 체인보다 더 많은 총 엔트로피를 만들어야 합니다. workshare가 있으면:

* 각 블록이 KawPow만 있을 때보다 더 많은 엔트로피를 누적
* 재구성 공격 비용이 비례적으로 증가(공격자는 블록 난이도+workshare 엔트로피를 모두 넘어야 함)
* 다중 알고리즘 보안이 복합적으로 강화(공격자는 여러 알고리즘 해시레이트가 필요하거나, workshare 엔트로피 부족분을 상쇄할 만큼 추가 KawPow 작업이 필요)

**예시:** 1000 KawPow 엔트로피에 workshare 엔트로피 200( SHA-256 150, Scrypt 50 )이 더해져 총 1200이 되면, 공격자는 KawPow-only 체인보다 20% 더 많은 작업을 해야 재구성 가능합니다.

## 왜 채굴자들이 참여하나?

여전히 퍼즐이 남습니다. 왜 BCH 채굴자가 자신의 블록 보상을 QADDR로 보내고, 스스로 가져가지 않을까요?

답은 두 부류로 나뉩니다.

**부모 체인(BCH/LTC/DOGE/RVN) workshare 제출 채굴자:**
그들은 workshare 제출량에 비례해 Quai의 발행 스케줄로부터 QUAI 보상을 받습니다. 부모 체인 보조금은 프로토콜로 가지만, QUAI 지급이 그들을 보상합니다. 또한 그 workshare는 Quai를 적극적으로 보호하며, 추가 해시레이트 샘플로 합의를 강화하고 파이널리티를 앞당깁니다. 수익성은 다음에 달려 있습니다:

* QUAI 가격과 부모 체인 토큰 가격의 상대적 비율
* Quai의 workshare 보상률
* workshare 포함 경쟁(블록당 최대 9개 캡)

**Quai KawPow 블록 생산자:**
그들은 블록을 생산하며 표준 QUAI 블록 보상을 받습니다. KawPow로 직접 Quai를 보호하고, 프로토콜이 BCH/LTC/DOGE 보조금을 지속적으로 QUAI 매수로 전환하기 때문에 발생하는 SOAP 매수 압력의 수혜자가 됩니다.

이 역학은 매력적입니다. 부모 체인 채굴자는 수익 다각화(비 SOAP 블록에서는 네이티브 보상, SOAP 블록에서는 QUAI) 이점을 얻고, Quai는 외부 보안 기여와 영구적 매수 압력을 얻으며, 전통적 머지 마이닝 체인이 겪는 “순수 매도 압력” 문제를 피할 수 있습니다.

## 거버넌스와 로테이션

실무적 우려 하나: 네트워크 전체 하드포크 없이 QADDR을 바꾸거나 SOAP 파라미터를 조정하려면 어떻게 할까요?

Quai는 위원회 기반 거버넌스를 사용합니다. 소수의 서명자가 AuxTemplate을 만들고 서명하며, 각 템플릿은 다음을 지정합니다:

* 어떤 부모 체인인지(ChainID)
* 요구되는 지급 스크립트(PayoutScript = QADDR)
* 이전 블록 해시(PrevHash)
* ScriptSig 길이 제한
* 권고 채굴 파라미터(nBits, nTime mask 등)

템플릿은 정족수(예: 2-of-3 멀티시그) 이상의 위원회 서명으로 확정되고, Quai 합의는 포함된 AuxPoW가 유효하고 정족수 서명된 템플릿과 일치할 것을 요구합니다.

이를 통해 프로토콜은:

* 키가 손상되면 QADDR을 회전
* 부모 체인 참여 파라미터를 조정
* 지원 부모 체인을 단계적으로 추가/제거

하드포크 없이 수행할 수 있습니다. 이 위원회 구조는 기존 채굴 중앙화보다 개선된 모델입니다. 오늘날 부모 체인 채굴은 단일 통제 지점을 가진 대형 풀에 의해 지배됩니다. SOAP은 단일 풀 운영자를 다수 서명 위원회로 대체해 신뢰를 분산합니다.

더 중요한 점은, 모든 Quai 블록 제안은 각 노드에서 로컬로 생성된다는 것입니다. 따라서 부모 체인의 신뢰 모델은 기존 풀 지배 구조와 같거나 더 낫고, Quai 자체의 탈중앙성은 전혀 변하지 않습니다. 노드는 블록 생산에 대한 완전한 자율성을 유지하고, 위원회는 지급 주소와 기본 파라미터를 지정하는 템플릿에만 서명합니다.

## 보안과 라이브니스

마지막으로 보안 모델에 대해 덧붙이면, SOAP은 “우아하게 실패”하도록 설계되었습니다. 부모 체인 참여가 0으로 떨어져도(어떤 BCH/LTC/DOGE/KawPow 채굴자도 workshare를 제출하지 않아도) Quai는 KawPow 블록을 정상적으로 계속 생산합니다. 라이브니스가 외부 체인 생산에 묶이지 않습니다. workshare는 순수한 추가 요소입니다.

이는 자식 체인이 부모 체인 블록에 의존하는 일부 머지 마이닝 구조와 대비됩니다. (만약 “모든 Quai 블록이 최소 1개의 부모 AuxPoW를 반드시 포함해야 한다”는 규칙이 있었다면, Quai 라이브니스가 부모 체인 출블록에 종속되어 취약해졌을 겁니다.)

SOAP의 철학은 이렇습니다. 외부 참여가 있으면 이점을 취하되, 외부가 사라져도 망가지지 않는다.

실제 보안 이익은 하드웨어 기반을 다변화하고, 채굴자들이 단순히 보상을 추출하는 대신 Quai의 성공과 정렬되도록 하는 경제적 인센티브에서 나옵니다. 그 인센티브가 충분한지는 화이트페이퍼로 증명할 문제가 아니라 시장에서 경험적으로 드러날 문제입니다.

## 요약

SOAP은 부모 체인 보조금을 프로토콜 제어 주소로 라우팅해 QUAI를 바이백하도록 하여, 전통적 머지 마이닝을 프로토콜 보조금 메커니즘으로 바꿉니다. 구매된 QUAI는 두 가지 주요 목적에 쓰입니다: 소각하거나, QUAI를 잠그는 사용자(스테이킹 등)에게 보상하는 것. 이를 통해 외부 채굴자가 workshare로 QUAI를 벌 수 있게 하면서도 지속적인 매수 압력을 만듭니다.

기술적으로 SOAP은 AuxPoW 구조로 부모 체인 참여를 증명하고, 표준 채굴 인프라와의 호환성을 위해 코인베이스 scriptSig에 커밋먼트를 넣습니다. Quai 블록은 KawPow-only(ProgPoW에서 전환 중)이지만, 다른 알고리즘(SHA-256, Scrypt, 그리고 KawPow 자체)의 workshare가 포함되어 QUAI 보상을 받을 수 있어, 서로 다른 하드웨어 클래스가 보안에 기여하도록 합니다.

workshare 메커니즘은 FruitChains 및 PRS 프로토콜을 기반으로 하며, 채굴 풀이 채굴자 기여도를 추정하는 통계적 샘플링 기법을 온체인으로 가져옵니다.

SOAP의 성공은 시장 메커니즘에 달려 있습니다. 즉 채굴자들이 QUAI 보상이 경쟁력 있다고 느끼는지, 그리고 “비용병적” 해시레이트가 충분해 QUAI에 순매수 압력을 만들 수 있는지에 달려 있습니다. 프로토콜은 외부 체인(BCH, LTC, DOGE)의 보조금을 시장가로 안전 비용으로 지불하고 지속적인 QUAI 매수로 전환합니다. 이는 자식 체인이 순수 매도 압력에 시달리는 전통적 머지 마이닝 경제학을 뒤집습니다. 외부 보조금이 프로토콜 금고 유입으로 바뀌어 토큰 유동성을 지지하고, 채굴자는 공정한 QUAI 보상을 받습니다.
